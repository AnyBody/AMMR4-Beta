Shank = {
    
  AnyRefNode LigTibioTalarPosterior = {
    sRel = .Scale(.StdPar.LigTibioTalarPosterior);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };  
  AnyRefNode LigTibioTalarAnterior = {
    sRel = .Scale(.StdPar.LigTibioTalarAnterior);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };  
  AnyRefNode LigTibioCalcaneal = {
    sRel = .Scale(.StdPar.LigTibioCalcaneal);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };  
  AnyRefNode LigTibioNavicular = {
    sRel = .Scale(.StdPar.LigTibioNavicular);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };  
  AnyRefNode LigTaloFibularPosterior = {
    sRel = .Scale(.StdPar.LigTaloFibularPosterior);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };  
  AnyRefNode LigTaloFibularAnterior = {
    sRel = .Scale(.StdPar.LigTaloFibularAnterior);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };  
  AnyRefNode LigCalcaneoFibular = {
    sRel = .Scale(.StdPar.LigCalcaneoFibular);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };  
  AnyRefNode PeroneusTertius1Node = {sRel = .Scale(.StdPar.PeroneusTertius1Node);};
  AnyRefNode PeroneusTertius2Node = {sRel = .Scale(.StdPar.PeroneusTertius2Node);};
  AnyRefNode PeroneusTertius3Node = {sRel = .Scale(.StdPar.PeroneusTertius3Node);};  
  AnyRefNode PeroneusTertiusViaNode1 = {sRel = .Scale(.StdPar.PeroneusTertiusViaNode1);};
  
}; // end Shank

Foot = {
  
  //These pointers and values are only used for compatibility with references in the LegTD files using the stiff foot originally.
  //It forwards the references to the coresponding element of the detailed foot.
  AnyRefFrame &AnatomicalFrame = Talus.AnatomicalFrame;
  AnyRefFrame &ScalingNode = Talus.ScalingNode;
  AnyRefFrame &SubTalarJoint = Calcaneus.SubTalarJoint;  
  AnyRefFrame &HeelNode = Calcaneus.HeelNode;  
//  AnyRefFrame &HeelContactNodeLow = Calcaneus.HeelContactNodeLow;  
//  AnyRefFrame &BigToeNode = Toe1.DistalPhalange1.ToeTip;
//  AnyRefFrame &ToeMedialContactNode = ProximalPhalange1.ToeMedialContactNode;  
//  AnyRefFrame &ToeLateralContactNode = ProximalPhalange5.ToeLateralContactNode;  
  
  
  AnyFolder &StdPar = ..ModelParameters.FootGM;
  AnyVar Sign = ..Sign;
  AnyFloat pUnscaled = {StdPar.LateralMalleolus, StdPar.MedialMalleolus, StdPar.Metatarsal2PlantarNode,StdPar.HeelPlantarNode, StdPar.Metatarsal5PlantarNode, StdPar.Metatarsal1PlantarNode};
  // p={LateralMalleolus, MedialMalleolus, Metatarsal2, Heel, Metatarsal5, Metatarsal1} //bony landmarks to define orgin and long axis of the foot
  // and three coplanar points to define the horizontal plane parallel to the ground. These can be on the bones, skin, shoe, etc. and
  // determine the proximal-distal axis of the foot and ankle plantarflexion zero value

  
  Talus = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar =.StdPar.Talus;
    
    AnyFloat pUnscaled = .pUnscaled;
    #define MACRO_CONSTRUCT_ANATOMICAL_FRAME_s(p, SIGN) 0.5*(p[0]+p[1])
    #define MACRO_CONSTRUCT_ANATOMICAL_FRAME_A(p, SIGN) RotMat(0.5*(p[0]+p[1]),0.5*(p[0]+p[1]) + cross(p[4]-p[3],p[5]-p[3])*SIGN, p[2]) * RotMat(-0.5*pi,z) * RotMat(1*pi,y)

    AnyRefNode AnatomicalFrame =
    {
      AnyFloat pScaled = .Scale(.pUnscaled);
      sRel = MACRO_CONSTRUCT_ANATOMICAL_FRAME_s(pScaled, .Sign);
      ARel = MACRO_CONSTRUCT_ANATOMICAL_FRAME_A(pScaled, .Sign);
      AnyVec3 sRelUnscaled = MACRO_CONSTRUCT_ANATOMICAL_FRAME_s(.pUnscaled, .Sign);///< Generic unscaled position of foot ScalingNode
      AnyMat33 ARelUnscaled = MACRO_CONSTRUCT_ANATOMICAL_FRAME_A(.pUnscaled, .Sign);///< Generic unscaled rotation of foot ScalingNode
    };
    #undef MACRO_CONSTRUCT_ANATOMICAL_FRAME_s
    #undef MACRO_CONSTRUCT_ANATOMICAL_FRAME_A
    
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode TaloNavicularJoint = 
    {
      sRel = ..Navicular.TaloNavicularJoint.sRel;
      ARel = ..Navicular.TaloNavicularJoint.ARel;
    };
    AnyRefNode MedialMalleolus = 
    {
      sRel = .Scale(.StdPar.MedialMalleolus);
      //    AnyDrawRefFrame drw={ScaleXYZ=2*{0.005,0.005,0.005};RGB={1,0,0};};
    };
    AnyRefNode LateralMalleolus = 
    {
      sRel = .Scale(.StdPar.LateralMalleolus);
      //    AnyDrawRefFrame drw={ScaleXYZ=2*{0.005,0.005,0.005};RGB={1,0,0};};
    };

    //****************
    //Ligaments nodes
    //****************
    AnyRefNode LigTibioTalarPosterior = {
      sRel = .Scale(.StdPar.LigTibioTalarPosterior);
    };    
    AnyRefNode LigTibioTalarAnterior = {
      sRel = .Scale(.StdPar.LigTibioTalarAnterior);
    };    
    AnyRefNode LigTaloFibularPosterior = {
      sRel = .Scale(.StdPar.LigTaloFibularPosterior);
    };    
    AnyRefNode LigTaloFibularAnterior = {
      sRel = .Scale(.StdPar.LigTaloFibularAnterior);
    };        
    AnyRefNode FlexorHallucisLongusViaNode1= {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorHallucisLongusViaNode1);
    };
    
  }; // End of Talus
  
  Calcaneus = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.Calcaneus;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode CalcaneoCuboidJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.03,0.03,0.03};RGB={1,0.5,0};};
      sRel = ..Cuboid.CalcaneoCuboidJoint.sRel;
      ARel = ..Cuboid.CalcaneoCuboidJoint.ARel;// *RotMat(7*pi/180,z); // modified
    };    
    AnyRefNode SubTalarJointAxisRef = 
    {
      sRel = .Scale(.StdPar.SubTalarJointAxisRef);
      //AnyDrawRefFrame drw2={ScaleXYZ={0.02,0.02,0.02}*2;RGB={0,0,1};};
    };    
    AnyRefNode HeelNode = 
    {
      sRel = .Scale(.StdPar.HeelNode); //Taken from TD leg
    };    
    AnyRefNode TuberCalcanei = 
    {
      sRel = .Scale(.StdPar.TuberCalcanei);
      //    AnyDrawRefFrame drw2={ScaleXYZ={0.02,0.02,0.02}*2;RGB={0,0,1};};
    };    
    AnyRefNode MedialProcess = 
    {
      sRel = .Scale(.StdPar.MedialProcess);
      //    AnyDrawRefFrame drw2={ScaleXYZ={0.02,0.02,0.02}*2;RGB={0,0,1};};
    };    
    AnyRefNode HeelFlatNode = 
    {
      sRel = .Scale(.StdPar.HeelFlatNode);
      ARel = RotMat(pi,x)*RotMat(pi/2,y);
      //    AnyDrawRefFrame drw2={ScaleXYZ={0.02,0.02,0.02};RGB={0,0,1};};
    };  
    AnyRefNode HeelContactNodeLow =
    {
      sRel = .Scale(.StdPar.HeelContactNodeLow);
    };  
    AnyRefNode HeelContactNodeLateral =
    {
      sRel = .Scale(.StdPar.HeelContactNodeLateral);
    };  
    AnyRefNode HeelContactNodeMedial =
    {
      sRel = .Scale(.StdPar.HeelContactNodeMedial);
    };  
    AnyRefNode HeelStrikeNode = 
    {
      sRel = .Scale(.StdPar.HeelStrikeNode);
      ARel = RotMat(pi,x)*RotMat(pi/2,y);
      //    AnyDrawRefFrame drw2={ScaleXYZ={0.02,0.02,0.02};RGB={0,0,1};};
    };   
    AnyRefNode SustentaculumTali= 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.SustentaculumTali);
    };
    AnyRefNode CenterNode= 
    {
      sRel = .Scale(.StdPar.CenterNode); //this is sCoM
    };
    AnyRefNode LongitudinalMedialArchNode = {
      sRel = .Scale(.StdPar.LongitudinalMedialArchNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode LongitudinalLateralArchNode = {
      sRel = .Scale(.StdPar.LongitudinalLateralArchNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode TendonCalcaneousNode= 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      //sRel = .Scale({-0.01+0.01702725, 0.01+0.1094617, ....Sign*(0.0008899511+.02)});
      sRel = .Scale(.StdPar.TendonCalcaneousNode);      
    };
    AnyRefNode SoleusMedialis1Node= 
    {
      sRel = .TendonCalcaneousNode.sRel; //{0.027, 0.103, ....Sign*-0.005}*.ScaleMat;
    };
    AnyRefNode SoleusMedialis2Node= 
    {
      sRel = .TendonCalcaneousNode.sRel; //{0.027, 0.103, ....Sign*-0.005}*.ScaleMat;
    };
    AnyRefNode SoleusMedialis3Node= 
    {
      sRel = .TendonCalcaneousNode.sRel; //{0.027, 0.103, ....Sign*-0.005}*.ScaleMat;
    };
    AnyRefNode SoleusLateralis1Node= 
    {
      sRel = .TendonCalcaneousNode.sRel; //{0.027, 0.107, ....Sign*0.007}*.ScaleMat;
    };
    AnyRefNode SoleusLateralis2Node= 
    {
      sRel = .TendonCalcaneousNode.sRel; //{0.027, 0.107, ....Sign*0.007}*.ScaleMat;
    };
    AnyRefNode SoleusLateralis3Node= 
    {
      sRel = .TendonCalcaneousNode.sRel; //{0.027, 0.107, ....Sign*0.007}*.ScaleMat;
    };
    AnyRefNode GastrocnemiusLateralis1Node= 
    {
      sRel = .TendonCalcaneousNode.sRel; //{0.027, 0.107, ....Sign*0.007}*.ScaleMat;
    };
    AnyRefNode GastrocnemiusMedialis1Node= 
    {
      sRel = .TendonCalcaneousNode.sRel; //{0.020, 0.111, ....Sign*0.001}*.ScaleMat;
    };
    AnyRefNode Plantaris1Node= 
    {
      sRel = .TendonCalcaneousNode.sRel; //{0.029, 0.102, ....Sign*-0.003}*.ScaleMat;
    };
    AnyRefNode FlexorHallucisLongusViaNode6= 
    {
      AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorHallucisLongusViaNode6);
    };
    AnyRefNode FlexorHallucisLongusViaNode7= 
    {
      AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorHallucisLongusViaNode7);
    };
    AnyRefNode FlexorHallucisLongusViaNode8= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorHallucisLongusViaNode8);
    };
    AnyRefNode PeroneusBrevisViaNode3= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusBrevisViaNode3);
    };
    AnyRefNode PeroneusBrevisViaNode4= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusBrevisViaNode4);
    };
    AnyRefNode PeroneusLongusViaNode3= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusLongusViaNode3);
    };
    AnyRefNode PeroneusLongusViaNode4= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusLongusViaNode4);
    };
    AnyRefNode TibialisPosteriorLateralisViaNode8= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorLateralisViaNode8);
    };
    AnyRefNode TibialisPosteriorMedialisViaNode9= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorMedialisViaNode9);
    };
    AnyRefNode TibialisPosteriorViaNode10= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorViaNode10);
    };
    AnyRefNode TibialisPosteriorViaNode11= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorViaNode11);
    };
    AnyRefNode FlexorDigitorumLongusViaNode7= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode7);
    };
    //  Moved from tasrsals to reproduce the extensor retinaculum inferior
    AnyRefNode PeroneusTertiusViaNode3= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusTertiusViaNode3);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode5= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode5);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode5Bis= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode5Bis);
    };
    AnyRefNode ExtensorHallucisLongusViaNode7= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorHallucisLongusViaNode7);
    };
    
    //***********************
    //Ligaments nodes
    //***********************
    
    AnyRefNode LigAponeurosisPlantaris= 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.LigAponeurosisPlantaris);
    };    
    //  AnyRefNode LigLateralAponeurosisPlantaris= 
    //  {
    ////    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
    //    sRel = .Scale({-0.01843697, 0.08972377, ....Sign*0.008106899});
    //  };    
    AnyRefNode LigPlantareLongum = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigPlantareLongum);
    };    
    AnyRefNode LigTibioCalcaneal = {
      sRel = .SustentaculumTali.sRel;
    };    
    AnyRefNode LigCalcaneoFibular = {
      sRel = .Scale(.StdPar.LigCalcaneoFibular);
    };    
    AnyRefNode LigCalcaneoNavicularPlantar1 = {
      //    sRel = .Scale({0.02746646, 0.05083057, ....Sign*-0.01806011});
      sRel = .Scale(.StdPar.LigCalcaneoNavicularPlantar1);      
    };    
    AnyRefNode LigCalcaneoNavicularPlantar2 = {
      //    sRel = .Scale({0.0250344, 0.04708043, ....Sign*-0.0131952});
      sRel = .Scale(.StdPar.LigCalcaneoNavicularPlantar2);   
    };
    AnyRefNode LigCalcaneoNavicularPlantar3 = {
      sRel = .Scale(.StdPar.LigCalcaneoNavicularPlantar3);
      //     AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};      
    };
    AnyRefNode LigCalcaneoNavicularPlantar4 = {
      sRel = .Scale(.StdPar.LigCalcaneoNavicularPlantar4);
      //     AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    }; 
    AnyRefNode LigCalcaneoNavicularPlantar5 = {
      //     AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
      sRel = .Scale(.StdPar.LigCalcaneoNavicularPlantar5);
    };
    AnyRefNode LigCalcaneoNavicularPlantar6 = {
      sRel = .Scale(.StdPar.LigCalcaneoNavicularPlantar6);
      //     AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    };
    AnyRefNode LigCalcaneoCuboidPlantar1 = {
      sRel = .Scale(.StdPar.LigCalcaneoCuboidPlantar1);
    };    
    AnyRefNode LigCalcaneoCuboidPlantar2 = {
      sRel = .Scale(.StdPar.LigCalcaneoCuboidPlantar2);
    };    
    //AnyDrawRefFrame drw = {};
    
  }; // End of Calcaneus
    
  Cuboid = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.Cuboid;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode CalcaneoCuboidJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ=4*{0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.StdPar.CalcaneoCuboidJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel=0.5*(.CalcaneoCuboidJoint.sRel+.RefDist.sRel);
      ARel=RotMat(.CalcaneoCuboidJoint.sRel,.RefDist.sRel,.RefProx.sRel)*RotMat(....Sign*-pi/2,x);
    };    
    AnyRefNode TarsoMt4Joint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,1};};
      sRel = ..Metatarsal4.TarsoMtJoint.sRel;
      ARel = ..Metatarsal4.TarsoMtJoint.ARel; // *RotMat(-8*pi/180,z); // modified
    };
    AnyRefNode TarsoMt5Joint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,1};};
      sRel = ..Metatarsal5.TarsoMtJoint.sRel;
      ARel = ..Metatarsal5.TarsoMtJoint.ARel; // *RotMat(-10*pi/180,z); // modified
    };    
    AnyRefNode TubOsCub = 
    {
      //    AnyDrawNode drw={ScaleXYZ={0.003,0.003,0.003};RGB={1,0.5,0};};
      sRel = .Scale(.StdPar.TubOsCub);
      //    AnyDrawRefFrame drw2 ={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
    };      
    AnyRefNode LongitudinalLateralArchNode = {
      sRel = .Scale(.StdPar.LongitudinalLateralArchNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    
    //***********************
    //Muscles nodes
    //***********************
    AnyRefNode PeroneusLongusViaNode5= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusLongusViaNode5);
    };    
    AnyRefNode PeroneusLongusViaNode6= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusLongusViaNode6);
    };    
    AnyRefNode PeroneusLongusViaNode7= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusLongusViaNode7);
    };    
    AnyRefNode TibialisPosteriorNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorNode);
    };    
    
    //***********************
    //Ligaments nodes
    //***********************
    
    AnyRefNode LigPlantareLongumMtII = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigPlantareLongumMtII);
    };    
    AnyRefNode LigPlantareLongumMtIII = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigPlantareLongumMtIII);
    };    
    AnyRefNode LigPlantareLongumMtIV = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigPlantareLongumMtIV);
    };    
    AnyRefNode LigPlantareLongumMtV = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigPlantareLongumMtV);
    };    
    AnyRefNode LigCalcaneoCuboidPlantar1 = {
      sRel = .Scale(.StdPar.LigCalcaneoCuboidPlantar1);
    };    
    AnyRefNode LigCalcaneoCuboidPlantar2 = {
      sRel = .Scale(.StdPar.LigCalcaneoCuboidPlantar2);
    };
    //  AnyDrawRefFrame drw = {};
    
  }; // End of cuboid
    
  Navicular = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.Navicular;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;   
    
    AnyRefNode TaloNavicularJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ=4*{0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.StdPar.TaloNavicularJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.StdPar.RefDist);
    };
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.StdPar.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TaloNavicularJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.TaloNavicularJoint.sRel,.RefDist.sRel,{1.0,0.0,-....Sign*0.1});
    };
    AnyRefNode MedCuneiNaviJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = ..MedialCuneiform.CuneiNaviJoint.sRel;
      ARel = ..MedialCuneiform.CuneiNaviJoint.ARel;
    };
    AnyRefNode IntCuneiNaviJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = ..IntermediateCuneiform.CuneiNaviJoint.sRel;
      ARel = ..IntermediateCuneiform.CuneiNaviJoint.ARel;
    };
    AnyRefNode LatCuneiNaviJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = ..LateralCuneiform.CuneiNaviJoint.sRel;
      ARel = ..LateralCuneiform.CuneiNaviJoint.ARel;
    };
    AnyRefNode LongitudinalMedialArchNode = {
      sRel = .Scale(.StdPar.LongitudinalMedialArchNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };    
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode TibialisAnteriorViaNode2= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisAnteriorViaNode2);
    };
    AnyRefNode TibialisPosteriorNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorNode);
    };
    AnyRefNode TibialisPosteriorViaNode11= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorViaNode11);
    };    
    
    //***********************
    //Ligaments nodes
    //***********************
    
    AnyRefNode LigTibioNavicular = {
      sRel = .Scale(.StdPar.LigTibioNavicular);
    };
    AnyRefNode LigCalcaneoNavicularPlantar1 = {
      // sRel = .Scale({0.03073173, 0.03206972, ....Sign*-0.01952226});
      sRel = .Scale(.StdPar.LigCalcaneoNavicularPlantar1);
      
    };
    AnyRefNode LigCalcaneoNavicularPlantar2 = {
      //    sRel = .Scale({0.02675282, 0.03336712, ....Sign*-0.01096544});
      sRel = .Scale(.StdPar.LigCalcaneoNavicularPlantar2);
    };    
    AnyRefNode LigCalcaneoNavicularPlantar3 = {
      sRel =.Scale(.StdPar.LigCalcaneoNavicularPlantar3);
      //  AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    };
    AnyRefNode LigCalcaneoNavicularPlantar4 = {
      sRel =.Scale(.StdPar.LigCalcaneoNavicularPlantar4);
      //  AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    };
    AnyRefNode LigCalcaneoNavicularPlantar5 = {
      sRel =.Scale(.StdPar.LigCalcaneoNavicularPlantar5);
      //     AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};      
    };
    AnyRefNode LigCalcaneoNavicularPlantar6 = {
      sRel =.Scale(.StdPar.LigCalcaneoNavicularPlantar6);
      //  AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    };    
    AnyRefNode ExtensorHallucisLongusViaNode7= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorHallucisLongusViaNode7);
    };
    
  }; // End of Navicular
  
  MedialCuneiform = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.MedialCuneiform;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;    
    
    AnyRefNode CuneiNaviJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1,0,0};};
      sRel = .Scale(.StdPar.CuneiNaviJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.StdPar.RefDist);
    };
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.StdPar.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.CuneiNaviJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.CuneiNaviJoint.sRel,.RefDist.sRel,{1.0,0.0,-....Sign*0.1});
    };
    AnyRefNode TarsoMtJoint = 
    {
      AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,1};};
      sRel = ..Metatarsal1.TarsoMtJoint.sRel;
      ARel = ..Metatarsal1.TarsoMtJoint.ARel;
    };
    AnyRefNode FDLSegNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FDLSegNode);
    };
    
    //***********************
    //Muscles nodes
    //***********************
    AnyRefNode ExtensorHallucisLongusViaNode8= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorHallucisLongusViaNode8);
    };    
    AnyRefNode TibialisAnteriorViaNode3= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      //    sRel = .JntTarsoMt.sRel + {0, 0, ....Sign*-0.014}*.JntTarsoMt.ARel';
      sRel = .Scale(.StdPar.TibialisAnteriorViaNode3);
    };    
    AnyRefNode TibialisAnteriorNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisAnteriorNode);
    };    
    AnyRefNode PeroneusLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusLongusNode);
    };    
    AnyRefNode TibialisPosteriorNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorNode);
    };
    
    //***********************
    //Ligaments nodes
    //***********************    
    
  }; // End of MedialCuneiform
  
  IntermediateCuneiform = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.IntermediateCuneiform;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode CuneiNaviJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={0,0,0};};
      sRel = .Scale(.StdPar.CuneiNaviJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //  AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.CuneiNaviJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.CuneiNaviJoint.sRel,.RefDist.sRel,{1.0,0.0, ....Sign*0.1});
    };    
    AnyRefNode TarsoMtJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ=10*{0.005,0.005,0.005};RGB={1,0,1};};
      sRel = ..Metatarsal2.TarsoMtJoint.sRel;
      ARel = ..Metatarsal2.TarsoMtJoint.ARel;
      
    };    
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode TibialisPosteriorNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorNode);
    };
    
    //***********************
    //Ligaments nodes
    //***********************   
    
  }; // End of IntermediateCuneiform
  
  LateralCuneiform = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.LateralCuneiform;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode CuneiNaviJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={0,0,0};};
      sRel = .Scale(.StdPar.CuneiNaviJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.CuneiNaviJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.CuneiNaviJoint.sRel,.RefDist.sRel,{1.0,0.0, ....Sign*0.4});
    };
    AnyRefNode TarsoMtJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,1};};
      sRel = ..Metatarsal3.TarsoMtJoint.sRel;
      ARel = ..Metatarsal3.TarsoMtJoint.ARel;      
    };    
    //  AnyRefNode ArticularLateralCunieform={
    //    sRel={0.02,0.01,....Sign*(0.013)};
    //    ARel = RotMat(....Sign*-30*pi/180,x)*RotMat(-10*pi/180,z);
    //  };   
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode TibialisPosteriorNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorNode);
    };
    
    //***********************
    //Ligaments nodes
    //***********************    
    
  }; // End of LateralCuneiform 
    
  
  //************************************************
  //Metatarsal bones
  //************************************************
  
  Metatarsal1 = {
    
    AnyFolder &FootType = ...FootType;
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.Metatarsal1;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode TarsoMtJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.TarsoMtJoint*.FootType.MetaScale);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.RefDist*.FootType.MetaScale);
    };
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.RefProx*.FootType.MetaScale);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TarsoMtJoint.sRel+.RefDist.sRel);    
      ARel = RotMat(.TarsoMtJoint.sRel,.RefDist.sRel,{1.0,0.0,-....Sign*0.1});
    };    
    AnyRefNode MtPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = .Scale(.StdPar.MtPhalJoint*.FootType.MetaScale);
      ARel = ..ProximalPhalange1.MtPhalJoint.ARel;
    };    
    AnyRefNode MtPhalJointTop ={
      sRel = .MtPhalJoint.sRel+({0, 0.02,0})*.MtPhalJoint.ARel';      
      AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};      
    };
    AnyRefNode ToeMedialContactNode = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.ToeMedialContactNode*.FootType.MetaScale);
    };    
    //For arch driving
    AnyRefNode MTHeadPlantarNode = {
      sRel = .Scale(.StdPar.MTHeadPlantarNode)*.FootType.MetaScale;
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };    
    AnyRefNode MTBasePlantarNode = {
      sRel = .Scale(.StdPar.MTBasePlantarNode)*.FootType.MetaScale;
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };    
    AnyRefNode MTHeadMedialNode = {
      sRel = .Scale(.StdPar.MTHeadMedialNode)*.FootType.MetaScale;
      //    AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefFrame &MetatarsalJoint1Node = MtPhalJoint;
    
    //***********************
    //Muscles nodes
    //***********************
    AnyRefNode ExtensorHallucisLongusViaNode9= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorHallucisLongusViaNode9*.FootType.MetaScale);
    };    
    AnyRefNode FlexorHallucisLongusViaNode9= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorHallucisLongusViaNode9*.FootType.MetaScale);
    };   
    AnyRefNode TibialisAnteriorNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisAnteriorNode*.FootType.MetaScale);
    };    
    AnyRefNode PeroneusLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusLongusNode*.FootType.MetaScale);
    };    
    
    //***********************
    //Ligaments nodes
    //***********************
        
    AnyRefNode LigAponeurosisPlantaris = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigAponeurosisPlantaris*.FootType.MetaScale);
    };    
    AnyRefNode LigMtTransversumProfundum = 
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundum*.FootType.MetaScale);
    };
    AnyRefNode LigMtTransversumProfundumVia1 = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundumVia1*.FootType.MetaScale);    
    };    
    AnyRefNode LigMtTransversumProfundumVia2 = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundumVia2*.FootType.MetaScale);      
    };
    
  }; // End of Metatarsal1
    
  Metatarsal2 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.Metatarsal2;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode TarsoMtJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.TarsoMtJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TarsoMtJoint.sRel+.RefDist.sRel);    
      ARel = RotMat(.TarsoMtJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode MtPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = ..ProximalPhalange2.MtPhalJoint.sRel;
      ARel = ..ProximalPhalange2.MtPhalJoint.ARel;
    };
    //For arch driving
    AnyRefNode MTHeadPlantarNode = {
      sRel = .Scale(.StdPar.MTHeadPlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode MTBasePlantarNode = {
      sRel = .Scale(.StdPar.MTBasePlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefFrame &MetatarsalJoint2Node = MtPhalJoint;
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode TibialisPosteriorNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorNode);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode6= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode6);
    };    
    AnyRefNode ExtensorDigitorumLongusViaNode6Bis= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode6Bis);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode9= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode9);
    };
    
    //***********************
    //Ligaments nodes
    //***********************
        
    AnyRefNode LigAponeurosisPlantaris = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigAponeurosisPlantaris);
    };    
    AnyRefNode LigPlantareLongum = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigPlantareLongum);
    }; 
    AnyRefNode LigMtTransversumProfundum = 
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundum);
    };
    AnyRefNode LigMtTransversumProfundumVia1 = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundumVia1);      
    };    
    AnyRefNode LigMtTransversumProfundumVia2 = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundumVia2);      
    };    
    
  }; // End of Metatarsal2  
  
  Metatarsal3 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.Metatarsal3;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;   
    
    AnyRefNode TarsoMtJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.TarsoMtJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TarsoMtJoint.sRel+.RefDist.sRel);    
      ARel = RotMat(.TarsoMtJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode MtPhalJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = ..ProximalPhalange3.MtPhalJoint.sRel;
      ARel = ..ProximalPhalange3.MtPhalJoint.ARel;
    };
    //For arch driving
    AnyRefNode MTHeadPlantarNode = {
      sRel = .Scale(.StdPar.MTHeadPlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode MTBasePlantarNode = {
      sRel = .Scale(.StdPar.MTBasePlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefFrame &MetatarsalJoint3Node = MtPhalJoint;
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode TibialisPosteriorNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorNode);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode9= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode9);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode9Bis= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode9Bis);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode12= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode12);
    };
    
    //***********************
    //Ligaments nodes
    //***********************
    
    AnyRefNode LigAponeurosisPlantaris = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigAponeurosisPlantaris);
    };    
    AnyRefNode LigPlantareLongum = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigPlantareLongum);
    };
    AnyRefNode LigMtTransversumProfundum = 
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundum);
    };
    AnyRefNode LigMtTransversumProfundumVia1 = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundumVia1);
    };
    AnyRefNode LigMtTransversumProfundumVia2 = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundumVia2);
    };
    
  }; // End of Metatarsal3  
  
  Metatarsal4 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.Metatarsal4;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode TarsoMtJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.TarsoMtJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TarsoMtJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.TarsoMtJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode MtPhalJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = ..ProximalPhalange4.MtPhalJoint.sRel;
      ARel = ..ProximalPhalange4.MtPhalJoint.ARel;
    };   
    //For arch driving
    AnyRefNode MTHeadPlantarNode = {
      sRel = .Scale(.StdPar.MTHeadPlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode MTBasePlantarNode = {
      sRel = .Scale(.StdPar.MTBasePlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefFrame &MetatarsalJoint4Node = MtPhalJoint;
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode TibialisPosteriorNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.TibialisPosteriorNode);
    };    
    AnyRefNode ExtensorDigitorumLongusViaNode12= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode12);
    };    
    AnyRefNode ExtensorDigitorumLongusViaNode12Bis= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode12Bis);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode15= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode15);
    };
    
    //***********************
    //Ligaments nodes
    //***********************
    
    AnyRefNode LigAponeurosisPlantaris = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigAponeurosisPlantaris);
    };    
    AnyRefNode LigPlantareLongum = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigPlantareLongum);
    };    
    AnyRefNode LigMtTransversumProfundum = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundum);
    };
    AnyRefNode LigMtTransversumProfundumVia1 = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundumVia1);
    };    
    AnyRefNode LigMtTransversumProfundumVia2 = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundumVia2);
    };  
    
  }; // End of Metatarsal4
    
  Metatarsal5 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.Metatarsal5;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode TarsoMtJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.TarsoMtJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefDist2 = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.RefDist2);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TarsoMtJoint.sRel+.RefDist.sRel);    
      ARel = RotMat(.TarsoMtJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode CenterNode2={
      //     AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*2;RGB={0,1,0};};
      sRel = 0.5*(.RefProx.sRel+.RefDist2.sRel);    
      ARel = RotMat(.RefProx.sRel,.RefDist2.sRel,{1.0,0.0,0.0});
    };
    AnyRefNode MtPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = ..ProximalPhalange5.MtPhalJoint.sRel;
      ARel = ..ProximalPhalange5.MtPhalJoint.ARel;
    };    
    AnyRefNode ToeLateralContactNode = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.StdPar.ToeLateralContactNode);
    };
    AnyRefNode FDLSegNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FDLSegNode);
    };
    //For arch driving
    AnyRefNode MTHeadPlantarNode = {
      sRel = .Scale(.StdPar.MTHeadPlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };    
    AnyRefNode MTBasePlantarNode = {
      sRel = .Scale(.StdPar.MTBasePlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode MTHeadLateralNode = {
      sRel = .Scale(.StdPar.MTHeadLateralNode);
      //      AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefFrame &MetatarsalJoint5Node = MtPhalJoint;
    
    //***********************
    //Muscles nodes
    //***********************1
    
    AnyRefNode PeroneusBrevis1Node= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusBrevis1Node);
    };    
    AnyRefNode PeroneusBrevis2Node= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusBrevis2Node);
    };
    AnyRefNode PeroneusBrevis3Node= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusBrevis3Node);
    };
    AnyRefNode PeroneusTertius1Node= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusTertius1Node);
    };    
    AnyRefNode PeroneusTertius2Node= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusTertius2Node);
    };    
    AnyRefNode PeroneusTertius3Node= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.PeroneusTertius3Node);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode15= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode15);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode18= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode18);
    };    
    
    //***********************
    //Ligaments nodes
    //***********************1
    
    AnyRefNode LigAponeurosisPlantaris = 
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigAponeurosisPlantaris);
    };    
    //  AnyRefNode LigLateralAponeurosisPlantaris = 
    //  {
    ////    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
    //    sRel = .Scale({-0.00999591, 0.02399151, ....Sign*0.03768708});
    //  };
    AnyRefNode LigPlantareLongum = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigPlantareLongum);
    };    
    AnyRefNode LigMtTransversumProfundum = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundum);
    };
    AnyRefNode LigMtTransversumProfundumVia1 = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundumVia1);
    };
    AnyRefNode LigMtTransversumProfundumVia2 = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigMtTransversumProfundumVia2);
    };
    
  }; // End of Metatarsal5
    
  
  //************************************************
  //Proximal Phalanges  bones
  //************************************************
  
  ProximalPhalange1 = {
    
    AnyFolder &FootType = ...FootType;
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.ProximalPhalange1;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode MtPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ=10*{0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.MtPhalJoint*.FootType.ProxPhalScale);
      ARel = .CenterNode.ARel*RotMat(....Sign*-35*pi/180,x);
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.RefDist*.FootType.ProxPhalScale);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.MtPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.MtPhalJoint.sRel,.RefDist.sRel,{0.1,0,0} );
    };   
    AnyRefNode DistPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      // sRel = .Scale({-0.001083079, -0.10166927, ....Sign*-0.008109532}*.FootType.ProxPhalScale);
      sRel =..DistalPhalange1.DistPhalJoint.sRel;      
      ARel = ..DistalPhalange1.DistPhalJoint.ARel;      
    };
    AnyRefNode RefDistTop ={
      sRel = .DistPhalJoint.sRel+({0, 0.01,0})*.DistPhalJoint.ARel';      
      AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};      
    };    
    AnyRefNode ToeMedialContactNode = {
      sRel = .Scale(.StdPar.ToeMedialContactNode);
    };
    //***********************
    //Muscles nodes
    //***********************
    
     AnyRefNode ExtensorHallucisLongusViaNode10= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorHallucisLongusViaNode10*.FootType.ProxPhalScale);
    };    
    AnyRefNode FlexorHallucisLongusViaNode10= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorHallucisLongusViaNode10*.FootType.ProxPhalScale);
    };
    
    //***********************
    //Ligaments nodes
    //***********************
    
    AnyRefNode LigAponeurosisPlantaris = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigAponeurosisPlantaris*.FootType.ProxPhalScale);
    };
    
  }; // End of ProximalPhalanges1
    
  ProximalPhalange2 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.ProximalPhalange2;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode MtPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.MtPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.MtPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.MtPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode ProxPhalJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = ..MiddlePhalange2.ProxPhalJoint.sRel;
      ARel = ..MiddlePhalange2.ProxPhalJoint.ARel;
    };
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusViaNode7= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode7);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode10= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode10);
    };   
    
    //***********************
    //Ligaments nodes
    //***********************
    
    AnyRefNode LigAponeurosisPlantaris = 
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigAponeurosisPlantaris);
    };
    
  }; // End of ProximalPhalanges2
    
  ProximalPhalange3 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.ProximalPhalange3;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode MtPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.MtPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.MtPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.MtPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode ProxPhalJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = ..MiddlePhalange3.ProxPhalJoint.sRel;
      ARel = ..MiddlePhalange3.ProxPhalJoint.ARel;      
    };    
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusViaNode10= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode10);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode13= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode13);
    };
    
    //***********************
    //Ligaments nodes
    //***********************
    
    AnyRefNode LigAponeurosisPlantaris = 
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigAponeurosisPlantaris);
    };
    
  }; // End of ProximalPhalanges3  
  
  ProximalPhalange4 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.ProximalPhalange4;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode MtPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.MtPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.MtPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.MtPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode ProxPhalJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = ..MiddlePhalange4.ProxPhalJoint.sRel;
      ARel = ..MiddlePhalange4.ProxPhalJoint.ARel;      
    };    
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusViaNode13= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode13);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode16= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode16);
    };
    
    //***********************
    //Ligaments nodes
    //***********************
    
    AnyRefNode LigAponeurosisPlantaris = 
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigAponeurosisPlantaris);
    };     
    
  }; // End of ProximalPhalanges4
    
  ProximalPhalange5 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.ProximalPhalange5;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode MtPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.MtPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.MtPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.MtPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode ProxPhalJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = ..MiddlePhalange5.ProxPhalJoint.sRel;
      ARel = ..MiddlePhalange5.ProxPhalJoint.ARel;      
    };
    AnyRefNode ToeLateralContactNode = {
      sRel = .Scale(.StdPar.ToeLateralContactNode);
    };

    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusViaNode16= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode16);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode19= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode19);
    };
    
    //***********************
    //Ligaments nodes
    //***********************
    
    AnyRefNode LigAponeurosisPlantaris = 
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.StdPar.LigAponeurosisPlantaris);
    };      
    
  }; // End of ProximalPhalanges5
    
  
  //************************************************
  //Middle Phalanges  bones
  //************************************************
  
  MiddlePhalange2 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.MiddlePhalange2;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode ProxPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.ProxPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.ProxPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.ProxPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode DistPhalJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = ..DistalPhalange2.DistPhalJoint.sRel;
      ARel = ..DistalPhalange2.DistPhalJoint.ARel;
    }; 
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusViaNode8= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode8);
    };    
    AnyRefNode ExtensorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusNode);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode11= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode11);
    };
    
  }; // End of MiddlePhalanges2
    
  MiddlePhalange3 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.MiddlePhalange3;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode ProxPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.ProxPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.ProxPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.ProxPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode DistPhalJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = ..DistalPhalange3.DistPhalJoint.sRel;
      ARel = ..DistalPhalange3.DistPhalJoint.ARel;
    }; 
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusViaNode11= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode11);
    };    
    AnyRefNode ExtensorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusNode);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode14= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode14);
    };
    
  }; // End of MiddlePhalanges3
    
  MiddlePhalange4 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.MiddlePhalange4;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode ProxPhalJoint = 
    {
      AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.ProxPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.ProxPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.ProxPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode DistPhalJoint = 
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = ..DistalPhalange4.DistPhalJoint.sRel;
      ARel = ..DistalPhalange4.DistPhalJoint.ARel;
    };
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusViaNode14= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode14);
    };    
    AnyRefNode ExtensorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusNode);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode17= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode17);
    };
    
  }; // End of MiddlePhalanges4
    
  MiddlePhalange5 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.MiddlePhalange5;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode ProxPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.ProxPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.ProxPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.ProxPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode DistPhalJoint = 
    {
      //  AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = ..DistalPhalange5.DistPhalJoint.sRel;
      ARel = ..DistalPhalange5.DistPhalJoint.ARel;
    };    
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusViaNode17= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusViaNode17);
    };    
    AnyRefNode ExtensorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusNode);
    };    
    AnyRefNode FlexorDigitorumLongusViaNode20= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusViaNode20);
    };
    
  }; // End of MiddlePhalanges5
  
  
  //************************************************
  //Distal Phalanges  bones
  //************************************************
    
  DistalPhalange1 = {
    
    AnyFolder &FootType = ...FootType;
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.DistalPhalange1;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode DistPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.DistPhalJoint*.FootType.DistPhalScale);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.RefDist*.FootType.DistPhalScale);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.DistPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.DistPhalJoint.sRel,.RefDist.sRel,{1.0,0.0,0.0});
    };
    AnyRefNode ToeTip = 
    {
      //     AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,1};};
      sRel = .Scale(.StdPar.ToeTip*.FootType.DistPhalScale);
    };
    AnyRefNode GroundContactNode = 
    {
      //     AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,1};};
      sRel = .Scale(.StdPar.GroundContactNode*.FootType.DistPhalScale);
    };
    AnyRefFrame &BigToeNode = ToeTip;
    
    //***********************
    //Muscles nodes
    //***********************
    AnyRefNode ExtensorHallucisLongus1Node = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorHallucisLongus1Node*.FootType.DistPhalScale);
    };    
    AnyRefNode ExtensorHallucisLongus2Node = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorHallucisLongus2Node*.FootType.DistPhalScale);
    };    
    AnyRefNode ExtensorHallucisLongus3Node = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorHallucisLongus3Node*.FootType.DistPhalScale);
    };
    AnyRefNode FlexorHallucisLongus1Node= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorHallucisLongus1Node*.FootType.DistPhalScale);
    };    
    AnyRefNode FlexorHallucisLongus2Node= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorHallucisLongus2Node*.FootType.DistPhalScale);
    };    
    AnyRefNode FlexorHallucisLongus3Node= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorHallucisLongus3Node*.FootType.DistPhalScale);
    };
    
  }; // End of DistalPhalanges1  
  
  DistalPhalange2 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.DistalPhalange2;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode DistPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.DistPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //     AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*2;RGB={0,1,0};};
      sRel = 0.5*(.DistPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.DistPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    AnyRefNode ToeTip = 
    {
      sRel = .Scale(.StdPar.ToeTip);
      //AnyDrawRefFrame drw2={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,1};};
    };    
    AnyRefNode GroundContactNode = 
    {
      //     AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,1};};
      sRel = .Scale(.StdPar.GroundContactNode);
    };
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusNode);
    };    
    AnyRefNode FlexorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusNode);
    };
    AnyRefNode &ExtensorDigitorumLongus1Node = ExtensorDigitorumLongusNode;
    
  }; // End of DistalPhalanges2
  
  DistalPhalange3 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.DistalPhalange3;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode DistPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.DistPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //     AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*2;RGB={0,1,0};};
      sRel = 0.5*(.DistPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.DistPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel); 
    };    
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusNode);
    };    
    AnyRefNode FlexorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusNode);
    };
    
  }; // End of DistalPhalanges3
    
  DistalPhalange4 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.DistalPhalange4;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode DistPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.DistPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //     AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*2;RGB={0,1,0};};
      sRel = 0.5*(.DistPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.DistPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };    
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusNode);
    };    
    AnyRefNode FlexorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusNode);
    };
    
  }; // End of DistalPhalanges4  
  
  DistalPhalange5 = {
    
    AnyVar Sign = .Sign;
    AnyFolder &StdPar = .StdPar.DistalPhalange5;
    
    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;
    /// For backwards compatability with AMMR 2.4 MoCap Marker protocols
    AnyRefNode& MoCapMarkerFrameAMMR24 = AnatomicalFrame;
    
    AnyRefNode DistPhalJoint = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.DistPhalJoint);
      ARel = .CenterNode.ARel;
    };    
    AnyRefNode RefDist = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.RefDist);
    };    
    AnyRefNode RefProx = 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.StdPar.RefProx);
    };    
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.DistPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.DistPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    
    //***********************
    //Muscles nodes
    //***********************
    
    AnyRefNode ExtensorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.ExtensorDigitorumLongusNode);
    };    
    AnyRefNode FlexorDigitorumLongusNode= 
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.StdPar.FlexorDigitorumLongusNode);
    };
    
  }; // End of DistalPhalanges5
  
  
}; // Foot

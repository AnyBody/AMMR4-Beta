
AnySeg PelvisSeg = {
  
  AnyFunTransform3D &Scale =..Scaling.GeometricalScaling.PelvisSeg.ScaleFunction;
  
  AnyVar MassS = ..Scaling.MassScaling.Pelvis.MassScale;
  
  // This segment includes Sacrum, and 2 times os coxae
  AnyVar MassStandard = ..StandardParameters.Pelvis.Mass;
  
  Mass = MassS*MassStandard;
  Jii = {0.0221,0.01,0.0221}; //Taken from SimpleSpineModel 
  sCoM = Scale({0.038, -0.050, 0.000000});
  JaboutCoMOnOff = On;
  
  AnyRefNode ScalingNode ={};
  
  AnyRefNode GroundPelvisJntNode = {sRel = .Scale({0.0,0.0,0.0});};
  AnyRefNode L5PelvisJntNode = {sRel = .Scale({0.043,-0.005,0.0});};
  
  AnyVar PelvisWidthStandard = ..StandardParameters.Pelvis.Width;     
  
  #if LEFT_LEG | RIGHT_LEG
  /// This HipJoint definition is for the SimpleLeg model
  AnyRefNode HipJointRight = {
    sRel = .Scale({0.03, -0.10, 0.08});
  };
  /// This HipJoint definition is for the SimpleLeg model
  AnyRefNode HipJointLeft = {sRel = .Scale({0.03, -0.10, -0.08});};
  
  AnyRefNode HipJointsCenter = {
    sRel = .Scale({0.03, -0.10, 0});
  };  
  #endif
  
  
  AnyRefNode PelvisAnatomicalFrame = {
    AnyVec3 RASIS = {0.1050804, -0.05009163, 0.1312};
    AnyVec3 LASIS = { 0.1050804, -0.05009163, -0.1312};
    AnyVec3 PSIS_Mid = {-0.03192611, 0.01085285, 0};
    AnyVec3 sRelUnscaled =  0.5*(RASIS+LASIS);
    AnyMat33 ARelUnscaled = RotMat(PSIS_Mid , sRelUnscaled ,RASIS )*RotMat(-pi/2,x);
    
    sRel =  0.5*(.Scale(RASIS)+.Scale(LASIS) );
    ARel = RotMat(.Scale(PSIS_Mid) , sRel,.Scale(RASIS) )*RotMat(-pi/2,x);
//    AnyDrawRefFrame drw = {RGB = {1,0,0};};
//ScaleXYZ =0.01*{1,1,1};
  };
  
    
  /// This node are used by different body part for adding mirrored nodes
  /// (muscle origins/insertions etc) to the pelvis segment
  AnyRefNode Right= {
    AnyInt Sign = 1;
    AnyFunTransform3D &Scale=.Scale;
  };
  /// This node are used by different body part for adding mirrored nodes
  /// (muscle origins/insertions etc) to the pelvis segment
  AnyRefNode Left=  {
    AnyInt Sign = -1;
    AnyFunTransform3D &Scale=.Scale;
  };

  AnyRefNode HipJointsCenterTD = {
    sRel = .Scale({0.035, -0.115, 0.0});
  };
  
  
  AnyRefNode PelvisSacrumJntNode = {
    sRel = .Scale({0.027,-0.030,0.000});
    //AnyDrawNode DrwNode = {
    //ScaleXYZ = {0.005,0.005,0.005};
    //RGB = {1,1,0};
    AnyFunTransform3D &Scale =.Scale;      
  };       
  AnyDrawSurf DrwSTL = {
    FileName = "BonesSpine\PelvisWOS";
    Opacity =         Main.DrawSettings.BonesOpacity.Pelvis;
    //FileName = ".\BonesSpine\SacrumSeg";
    RGB = ...ColorRef.Segments;
    
    AnyFunTransform3D &Scale =.Scale;      
  };
  
  AnyRefNode RASIS_internal = {
    AnyVec3 sRel0 = {0.1050804, -0.05009163, 0.1312};
    sRel = .Scale(sRel0);
  };
  AnyRefNode LASIS_internal ={
    AnyVec3 sRel0 = { 0.1050804, -0.05009163, -0.1312};
    sRel = .Scale(sRel0);
  };
  AnyRefNode PSIS_midpoint = {
    AnyVec3 sRel0 = {-0.03192611, 0.01085285, 0};
    sRel = .Scale(sRel0);
  };
  
  AnyRefNode RightAsisMarker = {
    sRel=.Scale({0.108750, -0.058906, 0.117813});
    
//          AnyDrawNode  drw={
//            ScaleXYZ={1,1,1}*Main.DrawSettings.Marker.Radius;
//            RGB=Main.DrawSettings.Marker.Color;
//          };
  };
  
  AnyRefNode LeftAsisMarker = {
    sRel=.Scale({0.108750, -0.058906, -0.117813});
    //            
//          AnyDrawNode  drw={
//            ScaleXYZ={1,1,1}*Main.DrawSettings.Marker.Radius;
//            RGB=Main.DrawSettings.Marker.Color;
//          };
  };
  
}; // End of PelvisSeg

